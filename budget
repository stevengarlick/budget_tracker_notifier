import base64
import os
import datetime
import plaid
from plaid import Client
import json
import time

PLAID_CLIENT_ID = '5c4b597400f5020010f2c337'
PLAID_SECRET = 'de6b098711c2d49a9bc024abf6e86d'
PLAID_PUBLIC_KEY = '49d7c3a184cad5ad50fb54a93b727c'
PLAID_ENV = 'development'

client = Client(client_id = PLAID_CLIENT_ID, secret=PLAID_SECRET,
                      public_key=PLAID_PUBLIC_KEY, environment=PLAID_ENV, api_version='2018-05-22')


access_token = None


def get_access_token():
  global access_token
  public_token = request.form['public_token']
  try:
    exchange_response = client.Item.public_token.exchange(public_token)
  except plaid.errors.PlaidError as e:
    return json.loads(format_error(e))

  pretty_print_response(exchange_response)
  access_token = exchange_response['access_token']
  return json.loads(exchange_response)

get_access_token()

